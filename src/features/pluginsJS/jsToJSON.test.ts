import { describe, test, expect } from "vitest";
import { convertPluginsJSToJSON } from "./jsToJSON";

describe("convertPluginsJSToJSON", () => {
  const expectedOutput = `{"name":"MockPlugin","status":true,"description":"desc text","parameters":{}}`;

  test("removes comment lines from JS source", () => {
    const input = [
      "// Generated by RPG Maker.",
      "// Do not edit this file directly.",
      "var $plugins =",
      "[",
      `{"name":"MockPlugin","status":true,"description":"desc text","parameters":{}},`,
      "];",
    ];
    const result = convertPluginsJSToJSON(input.join("\n"));
    expect(result).toEqual([expectedOutput]);
  });
  test("jsonParse", () => {
    const expected = {
      name: "MockPlugin",
      status: true,
      description: "desc text",
      parameters: {},
    };
    const value = JSON.parse(expectedOutput);
    expect(value).toEqual(expected);
  });
});
